import{n as d}from"./index-C9z9WAEj.js";var l=Object.defineProperty,c=(o,a,r,t)=>{for(var e=void 0,i=o.length-1,s;i>=0;i--)(s=o[i])&&(e=s(a,r,e)||e);return e&&l(a,r,e),e};const b=o=>{class a extends o{constructor(){super(...arguments),this.shouldFocusTrapWrap=!0,this.enabledPreventScroll=!1,this.focusTrapIndex=-1,this.focusableElements=[],this.isFocusTrapActivated=!1}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleTabKeydown.bind(this))}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleTabKeydown.bind(this))}async updated(t){super.updated(t),t.has("focusTrap")&&(this.focusTrap||this.deactivateFocusTrap())}activateFocusTrap(){this.focusTrap&&(this.isFocusTrapActivated=!0,this.setFocusableElements())}deactivateFocusTrap(){this.isFocusTrapActivated=!1,this.focusTrapIndex=-1,this.enabledPreventScroll=!1,document.body.style.overflow=""}hasNoClientRects(t){return t.getClientRects().length===0}hasZeroDimensions(t){const{width:e,height:i}=t.getBoundingClientRect(),{offsetWidth:s,offsetHeight:n}=t;return s+n+i+e===0}isNotVisible(t){return this.hasZeroDimensions(t)||this.hasNoClientRects(t)}hasHiddenStyle(t){const{display:e,opacity:i,visibility:s}=t.style;return e==="none"||i==="0"||s==="hidden"||s==="collapse"}hasComputedHidden(t){const e=getComputedStyle(t);return e.visibility==="hidden"||e.height==="0"||e.display==="none"}isHidden(t){return t.hasAttribute("hidden")||t.getAttribute("aria-hidden")==="true"||this.hasHiddenStyle(t)||this.isNotVisible(t)||this.hasComputedHidden(t)}isNotTabbable(t){return t.getAttribute("tabindex")==="-1"}isInteractiveElement(t){return!!(new Set(["BUTTON","DETAILS","EMBED","IFRAME","SELECT","TEXTAREA"]).has(t.tagName)||t instanceof HTMLAnchorElement&&t.hasAttribute("href")||t instanceof HTMLInputElement&&t.type!=="hidden"||(t instanceof HTMLAudioElement||t instanceof HTMLVideoElement)&&t.hasAttribute("controls")||(t instanceof HTMLImageElement||t instanceof HTMLObjectElement)&&t.hasAttribute("usemap")||t.hasAttribute("tabindex")&&t.tabIndex>-1)}isFocusable(t){return this.isHidden(t)||this.isNotTabbable(t)?!1:this.isInteractiveElement(t)}findFocusable(t,e=new Set){return t instanceof HTMLElement&&this.isFocusable(t)&&e.add(t),Array.from(t.children).forEach(s=>{const n=s;this.isFocusable(n)&&e.add(n),n.shadowRoot?this.findFocusable(n.shadowRoot,e):n.tagName==="SLOT"?n.assignedElements({flatten:!0}).forEach(u=>{u instanceof HTMLElement&&this.findFocusable(u,e)}):this.findFocusable(n,e)}),[...e]}setFocusableElements(){this.shadowRoot&&(this.focusableElements=this.findFocusable(this.shadowRoot,new Set))}setInitialFocus(t=0){this.focusableElements.length!==0&&(this.enabledPreventScroll&&(document.body.style.overflow="hidden"),this.focusableElements[t]&&(this.focusTrapIndex=t,this.focusableElements[t].focus()))}calculateNextIndex(t,e){const{length:i}=this.focusableElements;if(t===-1)return e>0?0:i-1;let s=t+e;return this.shouldFocusTrapWrap?(s<0&&(s=i-1),s>=i&&(s=0)):(s<0&&(s=0),s>=i&&(s=i-1)),s}getDeepActiveElement(){var e;let t=document.activeElement||document.body;for(;t instanceof HTMLElement&&((e=t.shadowRoot)!=null&&e.activeElement);)t=t.shadowRoot.activeElement;return t||document.body}findElement(t){return this.focusableElements.findIndex(e=>this.isEqualFocusNode(t,e))}isEqualFocusNode(t,e){return t.nodeType>=0?e.isEqualNode(t)&&e===t:!1}trapFocus(t){if(this.focusableElements.length===0)return;const e=this.getDeepActiveElement(),i=this.findElement(e);t?this.focusTrapIndex=this.calculateNextIndex(i,-1):this.focusTrapIndex=this.calculateNextIndex(i,1);const s=this.focusableElements[this.focusTrapIndex];s&&s.focus()}handleTabKeydown(t){!this.isFocusTrapActivated||!this.focusableElements.length||t.key==="Tab"&&(t.preventDefault(),this.trapFocus(t.shiftKey))}}return c([d({type:Boolean,reflect:!0,attribute:"should-focus-trap-wrap"})],a.prototype,"shouldFocusTrapWrap"),c([d({type:Boolean})],a.prototype,"enabledPreventScroll"),a};export{b as F};
