import{K as r}from"./listitem.component-B9oE0-TK.js";import{R as A}from"./roles-BH_hBfTz.js";import{T as b}from"./menusection.constants-CectB7Mc.js";import{O as T}from"./menubar.constants-Cq-jpWsM.js";import{a as g,p as h,C as E}from"./popover.component-v5AQLq7K.js";import{T as c}from"./menupopover.constants-D31hJpJi.js";import{i as R}from"./lit-element-D5KKan5q.js";import{T as f}from"./menuitem.component-C7TuudGn.js";import{T as k}from"./menuitemcheckbox.constants-Cja4JgF_.js";import{T as O}from"./menuitemradio.constants-DzN5_ujm.js";const I=R`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }
`,C=[I],m=s=>{var e,t;return[f,k,O].includes((t=(e=s==null?void 0:s.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))},v=s=>{var e;return((e=s==null?void 0:s.tagName)==null?void 0:e.toLowerCase())===c},w=s=>{var e,t;return((t=(e=s==null?void 0:s.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))===f&&!s.hasAttribute("disabled")},d=class d extends g{constructor(){super(),this.hidePopover=()=>{setTimeout(()=>{this.visible=!1,this.isTriggerClicked=!1},this.closeDelay)},this.onOutsidePopoverClick=e=>{if(h.peek()!==this)return;let t=!1;const i=e.composedPath();t=this.contains(e.target)||i.includes(this.triggerElement);const a=this.backdropElement?i.includes(this.backdropElement):!1;(!t||a)&&this.closeAllMenuPopovers()},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("click",this.handleMouseClick)}get menuItems(){var i;const e=(i=this.shadowRoot)==null?void 0:i.querySelector("slot");return((e==null?void 0:e.assignedElements({flatten:!0}))||[]).map(a=>a.tagName.toLowerCase()===b?Array.from(a.children).filter(n=>m(n)):m(a)?a:[]).flat().filter(a=>!!a&&!a.hasAttribute("disabled"))}connectedCallback(){super.connectedCallback(),this.role=A.MENU,this.ariaOrientation=T.VERTICAL,this.backdrop=!1,this.color=E.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async firstUpdated(e){var t;await super.firstUpdated(e),this.menuItems.length>0&&(this.menuItems.forEach(i=>i.setAttribute("tabindex","-1")),this.menuItems[0].setAttribute("tabindex","0")),(t=this.triggerElement)==null||t.setAttribute("aria-haspopup",A.MENU)}getCurrentIndex(e){return this.menuItems.findIndex(t=>t===e)}resetTabIndexAndSetFocus(e,t){e!==t&&(this.menuItems[t].setAttribute("tabindex","-1"),this.menuItems[e].setAttribute("tabindex","0"),this.menuItems[e].focus())}closeAllMenuPopovers(){for(;h.peek();){const e=h.pop();e&&e.hidePopover()}}hasSubmenuWithTriggerId(e){var t;return((t=this.parentElement)==null?void 0:t.querySelector(`${c}[triggerid="${e}"]`))!==null}handleMouseClick(e){const t=e.target,i=t.getAttribute("id");w(t)&&!this.hasSubmenuWithTriggerId(i)&&this.closeAllMenuPopovers()}resolveDirectionKey(e,t){if(!t)return e;switch(e){case r.ARROW_LEFT:return r.ARROW_RIGHT;case r.ARROW_RIGHT:return r.ARROW_LEFT;default:return e}}handleKeyDown(e){var n,u;const t=this.getCurrentIndex(e.target);if(t===-1)return;const i=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(e.key,i)){case r.HOME:{this.resetTabIndexAndSetFocus(0,t);break}case r.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,t);break}case r.ARROW_DOWN:{const o=t+1===this.menuItems.length?0:t+1;this.resetTabIndexAndSetFocus(o,t);break}case r.ARROW_UP:{const o=t-1===-1?this.menuItems.length-1:t-1;this.resetTabIndexAndSetFocus(o,t);break}case r.ARROW_RIGHT:{const o=(n=this.menuItems[t])==null?void 0:n.getAttribute("id");if(this.hasSubmenuWithTriggerId(o)){const p=(u=this.parentElement)==null?void 0:u.querySelector(`${c}[triggerid="${o}"]`);p&&p.showPopover()}break}case r.ARROW_LEFT:{v(this.parentElement)&&(this.hidePopover(),this.resetTabIndexAndSetFocus(0,t));break}case r.ESCAPE:{this.resetTabIndexAndSetFocus(0,t);break}}}};d.styles=[...g.styles,...C];let l=d;l.register(c);
