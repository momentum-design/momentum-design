import{S as I,W as c,n as A}from"./iframe-DopKAP5L.js";import{K as r}from"./keys-hFXe221I.js";import{a as M,T}from"./menuitemradio.constants-Cz0t6lks.js";import{b as m,d as p,c as O}from"./menupopover.constants-bd5ixPM-.js";import{T as b}from"./menuitem.component-emujSFjW.js";import{T as v}from"./menuitemcheckbox.constants-DMegu-J_.js";import{a as g,p as u,C as S}from"./popover.component-DCbmlhSn.js";const k=I`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }

  ::slotted(mdc-divider) {
    margin-block: 0.25rem;
  }
`,C=[k],h=n=>{var t;if(!n)return!1;const e=(t=n.getAttribute("role"))==null?void 0:t.toLowerCase();return e===c.MENUITEM||e===c.MENUITEMCHECKBOX||e===c.MENUITEMRADIO},E=n=>{var e;return((e=n==null?void 0:n.tagName)==null?void 0:e.toLowerCase())===m};var P=Object.defineProperty,y=(n,e,t,i)=>{for(var s=void 0,a=n.length-1,d;a>=0;a--)(d=n[a])&&(s=d(e,t,s)||s);return s&&P(e,t,s),s};const f=class f extends g{constructor(){super(),this.placement=p.PLACEMENT,this.menuItems=[],this.menuItemsWithSubMenus=[],this.onOutsidePopoverClick=e=>{if(u.peek()!==this)return;const t=e.composedPath(),i=this.contains(e.target)||t.includes(this.triggerElement)||t.includes(this),s=this.backdropElement?t.includes(this.backdropElement):!1;(!i||s)&&this.closeAllMenuPopovers()},this.togglePopoverVisible=e=>{var t;(t=this.triggerElement)!=null&&t.hasAttribute("soft-disabled")||!this.isEventFromTrigger(e)||(this.visible?this.hide():this.show())},this.handleItemCreation=e=>{const t=e.target;h(t)&&(e.stopImmediatePropagation(),t.addEventListener("destroyed",this.handleItemChangeEvent),t.addEventListener("disabled",this.handleItemChangeEvent))},this.handleItemChangeEvent=e=>{e.stopImmediatePropagation(),e.target&&e.type==="destroyed"&&(e.target.removeEventListener("destroyed",this.handleItemChangeEvent),e.target.removeEventListener("disabled",this.handleItemChangeEvent)),this.resetMenuNavigation()},this.resetMenuNavigation=()=>{this.collectMenuItems(),this.menuItems.find(t=>t.getAttribute("tabindex")==="0")||this.resetTabIndexes(0)},this.handleKeyDown=e=>{let t=!1;this.collectMenuItems();const i=e.target,s=this.getCurrentIndex(i);if(s===-1)return;this.resetTabIndexes(s);const a=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(e.key,a)){case r.HOME:{this.resetTabIndexAndSetFocus(0,s),t=!0;break}case r.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,s),t=!0;break}case r.ARROW_DOWN:{const o=s+1===this.menuItems.length?0:s+1;this.resetTabIndexAndSetFocus(o,s),t=!0;break}case r.ARROW_UP:{const o=s-1===-1?this.menuItems.length-1:s-1;this.resetTabIndexAndSetFocus(o,s),t=!0;break}case r.ARROW_RIGHT:{const o=this.getSubMenuPopoverOfTarget(i);o&&(o.show(),t=!0);break}case r.ARROW_LEFT:{E(this.parentElement)&&(this.hide(),this.resetTabIndexAndSetFocus(0,s),t=!0);break}case r.ESCAPE:{this.resetTabIndexAndSetFocus(0,s),t=!0;break}case r.ENTER:{this.getSubMenuPopoverOfTarget(i)||(this.closeAllMenuPopovers(),this.fireMenuItemAction(i),t=!0);break}case r.SPACE:{t=!0;break}}t&&(e.stopPropagation(),e.preventDefault())},this.handleKeyUp=e=>{let t=!1;const i=e.target;switch(e.key){case r.SPACE:{i.matches(`${M}, ${v}`)||this.getSubMenuPopoverOfTarget(i)||(this.closeAllMenuPopovers(),this.fireMenuItemAction(i),t=!0);break}}t&&(e.stopPropagation(),e.preventDefault())},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("keyup",this.handleKeyUp),this.addEventListener("click",this.handleMouseClick),this.addEventListener("created",this.handleItemCreation)}getSubMenuPopoverOfTarget(e){var i,s;const t=e.getAttribute("id");return t?(s=(i=this.parentElement)==null?void 0:i.querySelector)==null?void 0:s.call(i,`${m}[triggerid="${t}"]`):null}collectMenuItems(){var i;const e=(i=this.shadowRoot)==null?void 0:i.querySelector("slot"),t=(e==null?void 0:e.assignedElements({flatten:!0}))||[];this.menuItems=t.map(s=>s.tagName.toLowerCase()===T?Array.from(s.children).filter(a=>h(a)):h(s)?s:[]).flat().filter(s=>!!s&&!s.hasAttribute("disabled")),this.menuItemsWithSubMenus=this.menuItems.filter(s=>this.getSubMenuPopoverOfTarget(s))}getOpenSubMenusOfItems(e){const t=[];return!e||e.length===0||e.forEach(i=>{const s=this.getSubMenuPopoverOfTarget(i);s&&s.visible&&t.push(s)}),t}connectedCallback(){super.connectedCallback(),this.role=c.MENU,this.ariaOrientation=p.ORIENTATION,this.backdrop=!1,this.color=S.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async isOpenUpdated(e,t){return e===t||!this.triggerElement?Promise.resolve():(t&&(this.backdrop=![b,O].includes(this.triggerElement.tagName.toLowerCase())),t===!1&&this.menuItemsWithSubMenus.forEach(i=>{const s=this.getSubMenuPopoverOfTarget(i);s&&s.hide()}),this.resetMenuNavigation(),super.isOpenUpdated(e,t))}async firstUpdated(e){await super.firstUpdated(e),this.collectMenuItems(),this.resetTabIndexes(0)}resetTabIndexes(e){this.menuItems.length>0&&(this.menuItems.forEach(t=>t.setAttribute("tabindex","-1")),this.menuItems[e].setAttribute("tabindex","0"),this.menuItems[e].focus())}getCurrentIndex(e){return this.menuItems.findIndex(t=>t===e)}resetTabIndexAndSetFocus(e,t){e!==t&&(this.menuItems[t].setAttribute("tabindex","-1"),this.menuItems[e].setAttribute("tabindex","0"),this.menuItems[e].focus())}closeAllMenuPopovers(e){for(;u.peek()!==e&&E(u.peek());){const t=u.pop();if(t)t.hide();else break}}closeOtherSubMenusOnSameLevel(e){const t=this.menuItemsWithSubMenus.filter(s=>s!==e);this.getOpenSubMenusOfItems(t).forEach(s=>{s.hide()})}fireMenuItemAction(e){e.matches(b)&&e.dispatchEvent(new Event("action",{bubbles:!0,composed:!0}))}handleMouseClick(e){const t=e.target;if(e.stopPropagation(),!(!h(t)||!e.isTrusted)){if(this.getSubMenuPopoverOfTarget(t)){this.closeOtherSubMenusOnSameLevel(t);return}this.closeAllMenuPopovers(),this.fireMenuItemAction(t)}}resolveDirectionKey(e,t){if(!t)return e;switch(e){case r.ARROW_LEFT:return r.ARROW_RIGHT;case r.ARROW_RIGHT:return r.ARROW_LEFT;default:return e}}};f.styles=[...g.styles,...C];let l=f;y([A({type:String,reflect:!0})],l.prototype,"placement");l.register(m);
