import{b as d}from"./listitem.component-DiljlRM5.js";const n=(h,e)=>!!(h.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING),r=(h,e)=>!!(h.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING),o=h=>!!h;class l{constructor(e,t){this.cache=[],this.itemCreationHandler=i=>{this.addItem(i.target,void 0)},this.itemDestroyHandler=i=>{this.delete(i.detail.originalTarget)},this.host=e,e.addController(this),this.isValidItem=(t==null?void 0:t.isValidItem)||o,this.onStoreUpdate=t==null?void 0:t.onStoreUpdate}get items(){return this.cache}hostConnected(){this.host.addEventListener(d.CREATED,this.itemCreationHandler),this.host.addEventListener(d.DESTROYED,this.itemDestroyHandler)}hostDisconnected(){this.host.removeEventListener(d.CREATED,this.itemCreationHandler),this.host.removeEventListener(d.DESTROYED,this.itemDestroyHandler),this.reset()}add(e){this.addItem(e,void 0)}addAt(e,t){this.addItem(e,t)}getIndexToInsertInCache(e){if(!this.cache.length||!n(this.cache.at(-1),e))return-1;let t=0,i=this.cache.length-1;for(;t<=i;){const s=Math.floor((t+i)/2);r(this.cache[s],e)?t=s+1:i=s-1}return t}addItem(e,t=void 0){var s;const i=e;if(this.isValidItem(i)&&!this.cache.includes(i)){const a=t===void 0?this.getIndexToInsertInCache(i):t;this.onStoreUpdate&&((s=this.onStoreUpdate)==null||s.call(this,i,"added",a===-1?this.cache.length:a,this.cache.slice())),a===-1?this.cache.push(i):a>=0&&this.cache.splice(a,0,i)}}delete(e){var i;const t=this.cache.indexOf(e);t!==-1&&(this.onStoreUpdate&&((i=this.onStoreUpdate)==null||i.call(this,e,"removed",t,this.cache.slice())),this.cache.splice(t,1))}reset(e){this.cache.length=0,e&&this.cache.push(...e)}}const E=h=>{class e extends h{constructor(...i){super(...i),this.handleItemCreation=s=>{const a=s.target;a&&a.addEventListener(d.DESTROYED,this.handleItemRemovedEvent)},this.handleItemRemovedEvent=s=>{s.stopImmediatePropagation(),s.target&&s.type===d.DESTROYED&&(s.target.removeEventListener(d.DESTROYED,this.handleItemRemovedEvent),this.dispatchEvent(new CustomEvent(s.type,{bubbles:s.bubbles,composed:s.composed,detail:{originalTarget:s.target}})))},this.addEventListener(d.CREATED,this.handleItemCreation)}}return e};export{E as C,l as E};
