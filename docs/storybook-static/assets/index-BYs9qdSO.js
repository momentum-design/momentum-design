import{i as g,k as x}from"./lit-element-D5KKan5q.js";import{n as v}from"./property-Bj3TGwkg.js";import{u as T,C as E}from"./provider.component-DrWB4byV.js";import{R as O}from"./roles-CJI3JVG-.js";import{K as a}from"./keys-hFXe221I.js";import{b as h,T as A}from"./listitem.component-B3497azE.js";const C=o=>{class s extends o{constructor(...e){super(...e),this.loop="true",this.propagateAllKeyEvents=!1,this.initialFocus=0,this.handleNavigationKeyDown=t=>{const n=new Set([a.ARROW_DOWN,a.ARROW_UP,a.HOME,a.END]),d=window.getComputedStyle(this).direction==="rtl",m=this.resolveDirectionKey(t.key,d);if(!n.has(m))return;const c=t.target,r=this.getCurrentIndex(c);if(r!==-1){switch(this.resetTabIndexes(r),m){case a.HOME:{this.resetTabIndexAndSetFocus(0,r);break}case a.END:{this.resetTabIndexAndSetFocus(this.navItems.length-1,r);break}case a.ARROW_DOWN:{const u=this.shouldLoop()?0:r,I=r+1===this.navItems.length?u:r+1;this.resetTabIndexAndSetFocus(I,r);break}case a.ARROW_UP:{const u=this.shouldLoop()?this.navItems.length-1:r,I=r-1===-1?u:r-1;this.resetTabIndexAndSetFocus(I,r);break}}this.propagateAllKeyEvents||(t.stopPropagation(),t.preventDefault())}},this.handleNavigationClick=t=>{const n=this.getCurrentIndex(t.target);this.resetTabIndexes(n)},this.addEventListener("keydown",this.handleNavigationKeyDown),this.addEventListener("click",this.handleNavigationClick)}async firstUpdated(e){super.firstUpdated(e);const t=Math.max(Math.min(this.initialFocus,this.navItems.length-1),0);this.resetTabIndexAndSetFocus(t,void 0,!1)}getCurrentIndex(e){return this.navItems.findIndex(t=>t===e||!!(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY))}resetTabIndexes(e){if(this.navItems.length>0){this.navItems.forEach(n=>n.setAttribute("tabindex","-1"));const t=this.navItems[e]?e:0;this.navItems[t].setAttribute("tabindex","0"),this.navItems[t].focus()}}resetTabIndexAndSetFocus(e,t,n=!0){const{navItems:d}=this;if(d.length===0)return;const m=d[e]?e:0,c=d[m];e===t&&c&&c.getAttribute("tabindex")==="0"||(t===void 0?d.forEach(r=>r.setAttribute("tabindex","-1")):d[t]&&d[t].setAttribute("tabindex","-1"),c.setAttribute("tabindex","0"),n&&(c.focus({preventScroll:!0}),c.scrollIntoView({block:"nearest"})))}resolveDirectionKey(e,t){if(!t)return e;switch(e){case a.ARROW_LEFT:return a.ARROW_RIGHT;case a.ARROW_RIGHT:return a.ARROW_LEFT;default:return e}}shouldLoop(){return this.loop!=="false"}}return s},D=(o,s)=>!!(o.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_FOLLOWING),R=o=>!!o;class y{constructor(s,i){this.cache=[],this.itemCreationHandler=e=>{this.addItem(e.target,void 0)},this.itemDestroyHandler=e=>{this.delete(e.target)},this.host=s,s.addController(this),this.isValidItem=(i==null?void 0:i.isValidItem)||R,this.host.addEventListener(h.CREATED,this.itemCreationHandler),this.host.addEventListener(h.DESTROYED,this.itemDestroyHandler)}get items(){return this.cache}hostConnected(){}hostDisconnected(){}add(s){this.addItem(s,void 0)}addAt(s,i){this.addItem(s,i)}addItem(s,i=void 0){const e=s;if(this.isValidItem(e)&&!this.cache.includes(e)){const t=i===void 0?this.cache.findIndex(n=>D(e,n)):i;t===-1?this.cache.push(e):t>=0&&this.cache.splice(t,0,e)}}delete(s){const i=this.cache.indexOf(s);i!==-1&&this.cache.splice(i,1)}reset(s){this.cache.length=0,this.cache.push(...s||[])}}const S=o=>{class s extends o{constructor(...e){super(...e),this.handleItemCreation=t=>{const n=t.target;n&&n.addEventListener(h.DESTROYED,this.handleItemRemovedEvent)},this.handleItemRemovedEvent=t=>{if(t.stopImmediatePropagation(),t.target&&t.type===h.DESTROYED){t.target.removeEventListener(h.DESTROYED,this.handleItemRemovedEvent);const n=new Event(t.type,{bubbles:t.bubbles,composed:t.composed});Object.defineProperty(n,"target",{set(){},get:()=>t.target}),this.dispatchEvent(n)}},this.addEventListener(h.CREATED,this.handleItemCreation)}}return s},L=g`
  :host {
    display: flex;
    flex-direction: column;
    scroll-padding-top: 0.25rem;
    scroll-padding-bottom: 0.25rem;
  }

  :host::part(container) {
    display: flex;
    flex-direction: column;
    gap: 0rem;
    scroll-padding-top: 0.25rem;
    scroll-padding-bottom: 0.25rem;
  }
`,N=[L],_=T.constructTagName("list"),f={LOOP:"true",INITIAL_FOCUS:0};var F=Object.defineProperty,b=(o,s,i,e)=>{for(var t=void 0,n=o.length-1,d;n>=0;n--)(d=o[n])&&(t=d(s,i,t)||t);return t&&F(s,i,t),t};const p=class p extends C(S(E)){constructor(){super(),this.loop=f.LOOP,this.initialFocus=f.INITIAL_FOCUS,this.handleCreatedEvent=s=>{const i=s.target;this.isValidItem(i)&&(i.tabIndex=-1)},this.handleDestroyEvent=s=>{const i=s.target;if(!this.isValidItem(i)||i.tabIndex!==0)return;const e=this.navItems.findIndex(n=>n===i);if(e===-1)return;let t=e+1;t>=this.navItems.length&&(t=e-1),this.resetTabIndexes(t)},this.addEventListener(h.CREATED,this.handleCreatedEvent),this.addEventListener(h.DESTROYED,this.handleDestroyEvent),this.itemsStore=new y(this,{isValidItem:this.isValidItem})}connectedCallback(){super.connectedCallback(),this.setAttribute("role",O.LIST)}get navItems(){return this.itemsStore.items}isValidItem(s){return s.matches(`${A}:not([disabled])`)}render(){return x`
      <slot name="list-header"></slot>
      <!-- make the container slot role presentation to keep it ignored in a11y tree -->
      <slot part="container" role="presentation"></slot>
    `}};p.styles=[...E.styles,...N];let l=p;b([v({type:String,reflect:!0})],l.prototype,"loop");b([v({type:Number,reflect:!0,attribute:"initial-focus"})],l.prototype,"initialFocus");l.register(_);export{S as C,y as E,C as L,l as a};
