import{K as i}from"./TabIndexMixin-C4bLtOS_.js";const x=d=>{class u extends d{constructor(...e){super(...e),this.loop="true",this.propagateAllKeyEvents=!1,this.initialFocus=0,this.handleNavigationKeyDown=t=>{const r=new Set([i.ARROW_DOWN,i.ARROW_UP,i.HOME,i.END]),s=window.getComputedStyle(this).direction==="rtl",o=this.resolveDirectionKey(t.key,s);if(!r.has(o))return;const a=t.target,n=this.getCurrentIndex(a);if(n!==-1){switch(this.resetTabIndexes(n),o){case i.HOME:{this.resetTabIndexAndSetFocus(0,n);break}case i.END:{this.resetTabIndexAndSetFocus(this.navItems.length-1,n);break}case i.ARROW_DOWN:{const c=this.shouldLoop()?0:n,h=n+1===this.navItems.length?c:n+1;this.resetTabIndexAndSetFocus(h,n);break}case i.ARROW_UP:{const c=this.shouldLoop()?this.navItems.length-1:n,h=n-1===-1?c:n-1;this.resetTabIndexAndSetFocus(h,n);break}}this.propagateAllKeyEvents||(t.stopPropagation(),t.preventDefault())}},this.handleNavigationClick=t=>{const r=t.target,s=this.getCurrentIndex(r);if(s!==-1){const o=!(this.navItems[s]!==r&&document.activeElement===t.target);this.resetTabIndexAndSetFocus(s,void 0,o)}},this.addEventListener("keydown",this.handleNavigationKeyDown),this.addEventListener("click",this.handleNavigationClick)}async firstUpdated(e){super.firstUpdated(e);const t=Math.max(Math.min(this.initialFocus,this.navItems.length-1),0);this.resetTabIndexAndSetFocus(t,void 0,!1)}getCurrentIndex(e){return e?this.navItems.findIndex(t=>t===e||!!(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)):-1}resetTabIndexes(e){var t;if(this.navItems.length>0){this.navItems.forEach(s=>s.setAttribute("tabindex","-1"));const r=this.navItems[e]?e:0;this.navItems[r].setAttribute("tabindex","0"),(t=this.navItems[r])==null||t.focus()}}resetTabIndexAndSetFocus(e,t,r=!0){const{navItems:s}=this;if(s.length===0)return;const o=s[e]?e:0,a=s[o];e===t&&a&&a.getAttribute("tabindex")==="0"||(t===void 0?s.forEach(n=>n.setAttribute("tabindex","-1")):s[t]&&s[t].setAttribute("tabindex","-1"),a.setAttribute("tabindex","0"),r&&(a.focus({preventScroll:!0}),a.scrollIntoView({block:"nearest"})))}resolveDirectionKey(e,t){if(!t)return e;switch(e){case i.ARROW_LEFT:return i.ARROW_RIGHT;case i.ARROW_RIGHT:return i.ARROW_LEFT;default:return e}}shouldLoop(){return this.loop!=="false"}}return u};export{x as L};
