import{n as b}from"./index-C9z9WAEj.js";import{K as a}from"./listitem.component-63xfTCpM.js";import{R as A}from"./roles-BH_hBfTz.js";import{T as E}from"./menusection.constants-CectB7Mc.js";import{O as T}from"./menubar.constants-Cq-jpWsM.js";import{a as f,p as d,C as R}from"./popover.component-CcKN5R6t.js";import{T as l,D as k}from"./menupopover.constants-DvydllWR.js";import{i as O}from"./lit-element-D5KKan5q.js";import{T as g}from"./menuitem.component-DBitKzpT.js";import{T as I}from"./menuitemcheckbox.constants-Cja4JgF_.js";import{T as v}from"./menuitemradio.constants-DzN5_ujm.js";const C=O`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }
`,S=[C],m=r=>{var t,e;return[g,I,v].includes((e=(t=r==null?void 0:r.tagName)==null?void 0:t.toLowerCase)==null?void 0:e.call(t))},y=r=>{var t;return((t=r==null?void 0:r.tagName)==null?void 0:t.toLowerCase())===l},w=r=>{var t,e;return((e=(t=r==null?void 0:r.tagName)==null?void 0:t.toLowerCase)==null?void 0:e.call(t))===g&&!r.hasAttribute("disabled")};var N=Object.defineProperty,x=(r,t,e,i)=>{for(var s=void 0,o=r.length-1,c;o>=0;o--)(c=r[o])&&(s=c(t,e,s)||s);return s&&N(t,e,s),s};const u=class u extends f{constructor(){super(),this.placement=k.PLACEMENT,this.onOutsidePopoverClick=t=>{if(d.peek()!==this)return;let e=!1;const i=t.composedPath();e=this.contains(t.target)||i.includes(this.triggerElement);const s=this.backdropElement?i.includes(this.backdropElement):!1;(!e||s)&&this.closeAllMenuPopovers()},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("click",this.handleMouseClick)}get menuItems(){var i;const t=(i=this.shadowRoot)==null?void 0:i.querySelector("slot");return((t==null?void 0:t.assignedElements({flatten:!0}))||[]).map(s=>s.tagName.toLowerCase()===E?Array.from(s.children).filter(o=>m(o)):m(s)?s:[]).flat().filter(s=>!!s&&!s.hasAttribute("disabled"))}connectedCallback(){super.connectedCallback(),this.role=A.MENU,this.ariaOrientation=T.VERTICAL,this.backdrop=!1,this.color=R.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async firstUpdated(t){var e;await super.firstUpdated(t),this.menuItems.length>0&&(this.menuItems.forEach(i=>i.setAttribute("tabindex","-1")),this.menuItems[0].setAttribute("tabindex","0")),(e=this.triggerElement)==null||e.setAttribute("aria-haspopup",A.MENU)}getCurrentIndex(t){return this.menuItems.findIndex(e=>e===t)}resetTabIndexAndSetFocus(t,e){t!==e&&(this.menuItems[e].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.menuItems[t].focus())}closeAllMenuPopovers(){for(;d.peek();){const t=d.pop();t&&t.hidePopover()}}hasSubmenuWithTriggerId(t){var e;return((e=this.parentElement)==null?void 0:e.querySelector(`${l}[triggerid="${t}"]`))!==null}handleMouseClick(t){const e=t.target,i=e.getAttribute("id");w(e)&&!this.hasSubmenuWithTriggerId(i)&&this.closeAllMenuPopovers()}resolveDirectionKey(t,e){if(!e)return t;switch(t){case a.ARROW_LEFT:return a.ARROW_RIGHT;case a.ARROW_RIGHT:return a.ARROW_LEFT;default:return t}}handleKeyDown(t){var o,c;const e=this.getCurrentIndex(t.target);if(e===-1)return;const i=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(t.key,i)){case a.HOME:{this.resetTabIndexAndSetFocus(0,e);break}case a.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,e);break}case a.ARROW_DOWN:{const n=e+1===this.menuItems.length?0:e+1;this.resetTabIndexAndSetFocus(n,e);break}case a.ARROW_UP:{const n=e-1===-1?this.menuItems.length-1:e-1;this.resetTabIndexAndSetFocus(n,e);break}case a.ARROW_RIGHT:{const n=(o=this.menuItems[e])==null?void 0:o.getAttribute("id");if(this.hasSubmenuWithTriggerId(n)){const p=(c=this.parentElement)==null?void 0:c.querySelector(`${l}[triggerid="${n}"]`);p&&p.showPopover()}break}case a.ARROW_LEFT:{y(this.parentElement)&&(this.hidePopover(),this.resetTabIndexAndSetFocus(0,e));break}case a.ESCAPE:{this.resetTabIndexAndSetFocus(0,e);break}}}};u.styles=[...f.styles,...S];let h=u;x([b({type:String,reflect:!0})],h.prototype,"placement");h.register(l);
