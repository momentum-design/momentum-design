import{K as i}from"./TabIndexMixin-BvPyw8u7.js";const I=h=>{class d extends h{constructor(...t){super(...t),this.loop="true",this.propagateAllKeyEvents=!1,this.initialFocus=0,this.handleNavigationClick=s=>{const r=s.target,e=this.getCurrentIndex(r);if(e!==-1){const a=!(this.navItems.at(e)!==r&&document.activeElement===s.target);this.resetTabIndexAndSetFocus(e,void 0,a)}},this.addEventListener("keydown",this.handleNavigationKeyDown.bind(this)),this.addEventListener("click",this.handleNavigationClick)}async firstUpdated(t){super.firstUpdated(t),this.setInitialFocus()}setInitialFocus(){const t=Math.max(Math.min(this.initialFocus,this.navItems.length-1),0);this.resetTabIndexAndSetFocus(t,void 0,!1)}handleNavigationKeyDown(t){const s=new Set([i.ARROW_DOWN,i.ARROW_UP,i.HOME,i.END]),r=window.getComputedStyle(this).direction==="rtl",e=this.resolveDirectionKey(t.key,r);if(!s.has(e))return;const a=t.target,n=this.getCurrentIndex(a);if(n!==-1){switch(this.resetTabIndexes(n),e){case i.HOME:{this.resetTabIndexAndSetFocus(0,n);break}case i.END:{this.resetTabIndexAndSetFocus(this.navItems.length-1,n);break}case i.ARROW_DOWN:{const o=this.shouldLoop()?0:n,c=n+1===this.navItems.length?o:n+1;this.resetTabIndexAndSetFocus(c,n);break}case i.ARROW_UP:{const o=this.shouldLoop()?this.navItems.length-1:n,c=n-1===-1?o:n-1;this.resetTabIndexAndSetFocus(c,n);break}}this.propagateAllKeyEvents||(t.stopPropagation(),t.preventDefault())}}getCurrentIndex(t){return t?this.navItems.findIndex(s=>s===t||!!(s.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)):-1}resetTabIndexes(t,s=!0){if(this.navItems.length>0){this.navItems.forEach(a=>a.setAttribute("tabindex","-1"));const r=this.navItems.at(t)?t:0,e=this.navItems.at(r)??this.navItems.find(Boolean);e&&(e.setAttribute("tabindex","0"),s&&e.focus())}}resetTabIndexAndSetFocus(t,s,r=!0){const{navItems:e}=this;if(e.length===0)return;const a=e.at(t)??e.find(Boolean);t===s&&a&&a.getAttribute("tabindex")==="0"||(s===void 0?e.forEach(n=>n.setAttribute("tabindex","-1")):e.at(s)&&e.at(s).setAttribute("tabindex","-1"),a.setAttribute("tabindex","0"),r&&(a.focus({preventScroll:!0}),a.scrollIntoView({block:"nearest"})))}resolveDirectionKey(t,s){if(!s)return t;switch(t){case i.ARROW_LEFT:return i.ARROW_RIGHT;case i.ARROW_RIGHT:return i.ARROW_LEFT;default:return t}}shouldLoop(){return this.loop!=="false"}}return d};export{I as L};
