import{K as d,A as o}from"./KeyToActionMixin-D7mKMv1X.js";const I=c=>{class h extends d(c){constructor(...e){super(...e),this.loop="true",this.propagateAllKeyEvents=!1,this.initialFocus=0,this.handleNavigationClick=s=>{const a=s.target,n=this.getCurrentIndex(a);if(n!==-1){const t=!(this.navItems.at(n)!==a&&document.activeElement===s.target);this.resetTabIndexAndSetFocus(n,void 0,t,!1)}},this.addEventListener("keydown",this.handleNavigationKeyDown.bind(this)),this.addEventListener("click",this.handleNavigationClick)}async firstUpdated(e){super.firstUpdated(e),this.setInitialFocus()}setInitialFocus(){const e=Math.max(Math.min(this.initialFocus,this.navItems.length-1),0);this.resetTabIndexAndSetFocus(e,void 0,!1)}handleNavigationKeyDown(e){const s=this.getActionForKeyEvent(e,!0),a=new Set([o.DOWN,o.UP,o.HOME,o.END]);if(!s||!a.has(s))return;const n=e.target,t=this.getCurrentIndex(n);if(t!==-1){switch(this.resetTabIndexes(t),s){case o.HOME:{this.resetTabIndexAndSetFocus(0,t);break}case o.END:{this.resetTabIndexAndSetFocus(this.navItems.length-1,t);break}case o.DOWN:{const i=this.shouldLoop()?0:t,r=t+1===this.navItems.length?i:t+1;this.resetTabIndexAndSetFocus(r,t);break}case o.UP:{const i=this.shouldLoop()?this.navItems.length-1:t,r=t-1===-1?i:t-1;this.resetTabIndexAndSetFocus(r,t);break}}this.propagateAllKeyEvents||(e.stopPropagation(),e.preventDefault())}}getCurrentIndex(e){return e?this.navItems.findIndex(s=>s===e||!!(s.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)):-1}resetTabIndexes(e,s=!0){if(this.navItems.length>0){this.navItems.forEach(t=>t.setAttribute("tabindex","-1"));const a=this.navItems.at(e)?e:0,n=this.navItems.at(a)??this.navItems.find(Boolean);n&&(n.setAttribute("tabindex","0"),s&&n.focus())}}resetTabIndexAndSetFocus(e,s,a=!0,n=!0){const{navItems:t}=this;if(t.length===0)return;const i=t.at(e)??t.find(Boolean);e===s&&i&&i.getAttribute("tabindex")==="0"||(s===void 0?t.forEach(r=>r.setAttribute("tabindex","-1")):t.at(s)&&t.at(s).setAttribute("tabindex","-1"),i.setAttribute("tabindex","0"),a&&(i.focus({preventScroll:!0}),n&&i.scrollIntoView({block:"nearest"})))}shouldLoop(){return this.loop!=="false"}}return h};export{I as L};
