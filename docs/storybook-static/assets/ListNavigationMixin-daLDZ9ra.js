import{K as a}from"./TabIndexMixin-DfTHADxN.js";const I=h=>{class d extends h{constructor(...t){super(...t),this.loop="true",this.propagateAllKeyEvents=!1,this.initialFocus=0,this.handleNavigationClick=s=>{const r=s.target,n=this.getCurrentIndex(r);if(n!==-1){const i=!(this.navItems.at(n)!==r&&document.activeElement===s.target);this.resetTabIndexAndSetFocus(n,void 0,i,!1)}},this.addEventListener("keydown",this.handleNavigationKeyDown.bind(this)),this.addEventListener("click",this.handleNavigationClick)}async firstUpdated(t){super.firstUpdated(t),this.setInitialFocus()}setInitialFocus(){const t=Math.max(Math.min(this.initialFocus,this.navItems.length-1),0);this.resetTabIndexAndSetFocus(t,void 0,!1)}handleNavigationKeyDown(t){const s=new Set([a.ARROW_DOWN,a.ARROW_UP,a.HOME,a.END]),r=window.getComputedStyle(this).direction==="rtl",n=this.resolveDirectionKey(t.key,r);if(!s.has(n))return;const i=t.target,e=this.getCurrentIndex(i);if(e!==-1){switch(this.resetTabIndexes(e),n){case a.HOME:{this.resetTabIndexAndSetFocus(0,e);break}case a.END:{this.resetTabIndexAndSetFocus(this.navItems.length-1,e);break}case a.ARROW_DOWN:{const o=this.shouldLoop()?0:e,c=e+1===this.navItems.length?o:e+1;this.resetTabIndexAndSetFocus(c,e);break}case a.ARROW_UP:{const o=this.shouldLoop()?this.navItems.length-1:e,c=e-1===-1?o:e-1;this.resetTabIndexAndSetFocus(c,e);break}}this.propagateAllKeyEvents||(t.stopPropagation(),t.preventDefault())}}getCurrentIndex(t){return t?this.navItems.findIndex(s=>s===t||!!(s.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)):-1}resetTabIndexes(t,s=!0){if(this.navItems.length>0){this.navItems.forEach(i=>i.setAttribute("tabindex","-1"));const r=this.navItems.at(t)?t:0,n=this.navItems.at(r)??this.navItems.find(Boolean);n&&(n.setAttribute("tabindex","0"),s&&n.focus())}}resetTabIndexAndSetFocus(t,s,r=!0,n=!0){const{navItems:i}=this;if(i.length===0)return;const e=i.at(t)??i.find(Boolean);t===s&&e&&e.getAttribute("tabindex")==="0"||(s===void 0?i.forEach(o=>o.setAttribute("tabindex","-1")):i.at(s)&&i.at(s).setAttribute("tabindex","-1"),e.setAttribute("tabindex","0"),r&&(e.focus({preventScroll:!0}),n&&e.scrollIntoView({block:"nearest"})))}resolveDirectionKey(t,s){if(!s)return t;switch(t){case a.ARROW_LEFT:return a.ARROW_RIGHT;case a.ARROW_RIGHT:return a.ARROW_LEFT;default:return t}}shouldLoop(){return this.loop!=="false"}}return d};export{I as L};
