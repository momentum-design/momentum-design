import{b as h}from"./listitem.component-DLCTQFGX.js";const c=(a,e)=>!!(a.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING),n=a=>!!a;class l{constructor(e,t){this.cache=[],this.itemCreationHandler=s=>{this.addItem(s.target,void 0)},this.itemDestroyHandler=s=>{this.delete(s.target)},this.host=e,e.addController(this),this.isValidItem=(t==null?void 0:t.isValidItem)||n,this.onStoreUpdate=t==null?void 0:t.onStoreUpdate,this.host.addEventListener(h.CREATED,this.itemCreationHandler),this.host.addEventListener(h.DESTROYED,this.itemDestroyHandler)}get items(){return this.cache}hostConnected(){}hostDisconnected(){}add(e){this.addItem(e,void 0)}addAt(e,t){this.addItem(e,t)}addItem(e,t=void 0){var i;const s=e;if(this.isValidItem(s)&&!this.cache.includes(s)){const d=t===void 0?this.cache.findIndex(r=>c(s,r)):t;this.onStoreUpdate&&((i=this.onStoreUpdate)==null||i.call(this,s,"added",d===-1?this.cache.length:d,this.cache.slice())),d===-1?this.cache.push(s):d>=0&&this.cache.splice(d,0,s)}}delete(e){var s;const t=this.cache.indexOf(e);t!==-1&&(this.onStoreUpdate&&((s=this.onStoreUpdate)==null||s.call(this,e,"removed",t,this.cache.slice())),this.cache.splice(t,1))}reset(e){this.cache.length=0,this.cache.push(...e||[])}}const m=a=>{class e extends a{constructor(...s){super(...s),this.handleItemCreation=i=>{const d=i.target;d&&d.addEventListener(h.DESTROYED,this.handleItemRemovedEvent)},this.handleItemRemovedEvent=i=>{if(i.stopImmediatePropagation(),i.target&&i.type===h.DESTROYED){i.target.removeEventListener(h.DESTROYED,this.handleItemRemovedEvent);const d=new Event(i.type,{bubbles:i.bubbles,composed:i.composed});Object.defineProperty(d,"target",{set(){},get:()=>i.target}),this.dispatchEvent(d)}},this.addEventListener(h.CREATED,this.handleItemCreation)}}return e};export{m as C,l as E};
