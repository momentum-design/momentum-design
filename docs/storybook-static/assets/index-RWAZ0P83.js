import{n as T}from"./index-C9z9WAEj.js";import{K as o}from"./listitem.component-Bh3_BYs0.js";import{R as g}from"./roles-BH_hBfTz.js";import{T as E}from"./menusection.constants-CectB7Mc.js";import{a as f,p as c,C as k}from"./popover.component-Bw5zQP8M.js";import{T as h,D as A}from"./menupopover.constants-Df21F9dQ.js";import{i as R}from"./lit-element-D5KKan5q.js";import{T as b}from"./menuitem.component-BoKm6qLY.js";import{T as v}from"./menuitemcheckbox.constants-Cja4JgF_.js";import{T as O}from"./menuitemradio.constants-DzN5_ujm.js";const C=R`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }
`,I=[C],m=r=>{var e,t;return[b,v,O].includes((t=(e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))},S=r=>{var e;return((e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase())===h},w=r=>{var e,t;return((t=(e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))===b&&!r.hasAttribute("disabled")};var y=Object.defineProperty,P=(r,e,t,i)=>{for(var s=void 0,a=r.length-1,l;a>=0;a--)(l=r[a])&&(s=l(e,t,s)||s);return s&&y(e,t,s),s};const u=class u extends f{constructor(){super(),this.placement=A.PLACEMENT,this.onOutsidePopoverClick=e=>{if(c.peek()!==this)return;const t=e.target.closest(h);if(t&&c.has(t)){this.closeAllMenuPopovers(t);return}let i=!1;const s=e.composedPath();i=this.contains(e.target)||s.includes(this.triggerElement);const a=this.backdropElement?s.includes(this.backdropElement):!1;(!i||a)&&this.closeAllMenuPopovers()},this.togglePopoverVisible=()=>{var e;(e=this.triggerElement)!=null&&e.hasAttribute("soft-disabled")||(this.isTriggerClicked?this.hidePopover():(this.showPopover(),this.isTriggerClicked=!0))},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("click",this.handleMouseClick)}get menuItems(){var i;const e=(i=this.shadowRoot)==null?void 0:i.querySelector("slot");return((e==null?void 0:e.assignedElements({flatten:!0}))||[]).map(s=>s.tagName.toLowerCase()===E?Array.from(s.children).filter(a=>m(a)):m(s)?s:[]).flat().filter(s=>!!s&&!s.hasAttribute("disabled"))}connectedCallback(){super.connectedCallback(),this.role=g.MENU,this.ariaOrientation=A.ORIENTATION,this.backdrop=!1,this.color=k.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async firstUpdated(e){var t;await super.firstUpdated(e),this.menuItems.length>0&&(this.menuItems.forEach(i=>i.setAttribute("tabindex","-1")),this.menuItems[0].setAttribute("tabindex","0")),(t=this.triggerElement)==null||t.setAttribute("aria-haspopup",g.MENU)}getCurrentIndex(e){return this.menuItems.findIndex(t=>t===e)}resetTabIndexAndSetFocus(e,t){e!==t&&(this.menuItems[t].setAttribute("tabindex","-1"),this.menuItems[e].setAttribute("tabindex","0"),this.menuItems[e].focus())}closeAllMenuPopovers(e){for(;c.peek()!==e;){const t=c.pop();if(t)t.hidePopover();else break}}hasSubmenuWithTriggerId(e){var t;return((t=this.parentElement)==null?void 0:t.querySelector(`${h}[triggerid="${e}"]`))!==null}handleMouseClick(e){const t=e.target,i=t.getAttribute("id");w(t)&&!this.hasSubmenuWithTriggerId(i)&&this.closeAllMenuPopovers()}resolveDirectionKey(e,t){if(!t)return e;switch(e){case o.ARROW_LEFT:return o.ARROW_RIGHT;case o.ARROW_RIGHT:return o.ARROW_LEFT;default:return e}}handleKeyDown(e){var a,l;const t=this.getCurrentIndex(e.target);if(t===-1)return;const i=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(e.key,i)){case o.HOME:{this.resetTabIndexAndSetFocus(0,t);break}case o.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,t);break}case o.ARROW_DOWN:{const n=t+1===this.menuItems.length?0:t+1;this.resetTabIndexAndSetFocus(n,t);break}case o.ARROW_UP:{const n=t-1===-1?this.menuItems.length-1:t-1;this.resetTabIndexAndSetFocus(n,t);break}case o.ARROW_RIGHT:{const n=(a=this.menuItems[t])==null?void 0:a.getAttribute("id");if(this.hasSubmenuWithTriggerId(n)){const p=(l=this.parentElement)==null?void 0:l.querySelector(`${h}[triggerid="${n}"]`);p&&p.showPopover()}break}case o.ARROW_LEFT:{S(this.parentElement)&&(this.hidePopover(),this.resetTabIndexAndSetFocus(0,t));break}case o.ESCAPE:{this.resetTabIndexAndSetFocus(0,t);break}}}};u.styles=[...f.styles,...I];let d=u;P([T({type:String,reflect:!0})],d.prototype,"placement");d.register(h);
