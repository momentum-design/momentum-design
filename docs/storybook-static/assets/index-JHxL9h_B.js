import{n as E}from"./index-C9z9WAEj.js";import{K as o}from"./listitem.component-CHPaF0Zk.js";import{R as g}from"./roles-BH_hBfTz.js";import{T as u}from"./menuitem.component-D7F5qKBY.js";import{T}from"./menusection.constants-BCYXL6dH.js";import{a as f,p as l,C as k}from"./popover.component-gG75l09H.js";import{T as h,D as A}from"./menupopover.constants-CVQbBb-g.js";import{i as v}from"./lit-element-D5KKan5q.js";import{T as I}from"./menuitemcheckbox.constants-DmrkQGAP.js";import{T as O}from"./menuitemradio.constants-CPWIpsqE.js";const R=v`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }

  ::slotted(mdc-divider) {
    margin-block: 0.25rem;
  }
`,C=[R],b=r=>{if(!r)return!1;const t=r.tagName.toLowerCase();return[u,I,O].includes(t)},P=r=>{var t;return((t=r==null?void 0:r.tagName)==null?void 0:t.toLowerCase())===h},y=r=>{var t,e;return((e=(t=r==null?void 0:r.tagName)==null?void 0:t.toLowerCase)==null?void 0:e.call(t))===u&&!r.hasAttribute("disabled")};var N=Object.defineProperty,S=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,c;n>=0;n--)(c=r[n])&&(s=c(t,e,s)||s);return s&&N(t,e,s),s};const p=class p extends f{constructor(){super(),this.placement=A.PLACEMENT,this.onOutsidePopoverClick=t=>{if(l.peek()!==this)return;const e=this.findClosestPopover(t.target);if(e&&l.has(e)){this.closeAllMenuPopovers(e);return}const i=t.composedPath(),s=this.contains(t.target)||i.includes(this.triggerElement),n=this.backdropElement?i.includes(this.backdropElement):!1;(!s||n)&&this.closeAllMenuPopovers()},this.togglePopoverVisible=()=>{var t;(t=this.triggerElement)!=null&&t.hasAttribute("soft-disabled")||(this.isTriggerClicked?this.hidePopover():(this.showPopover(),this.isTriggerClicked=!0))},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("click",this.handleMouseClick)}get menuItems(){var i;const t=(i=this.shadowRoot)==null?void 0:i.querySelector("slot");return((t==null?void 0:t.assignedElements({flatten:!0}))||[]).map(s=>s.tagName.toLowerCase()===T?Array.from(s.children).filter(n=>b(n)):b(s)?s:[]).flat().filter(s=>!!s&&!s.hasAttribute("disabled"))}connectedCallback(){super.connectedCallback(),this.role=g.MENU,this.ariaOrientation=A.ORIENTATION,this.backdrop=!1,this.color=k.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async isOpenUpdated(t,e){return t===e||!this.triggerElement?Promise.resolve():(e&&(this.backdrop=this.triggerElement.tagName.toLowerCase()!==u),super.isOpenUpdated(t,e))}async firstUpdated(t){var e;await super.firstUpdated(t),this.menuItems.length>0&&(this.menuItems.forEach(i=>i.setAttribute("tabindex","-1")),this.menuItems[0].setAttribute("tabindex","0")),(e=this.triggerElement)==null||e.setAttribute("aria-haspopup",g.MENU)}getCurrentIndex(t){return this.menuItems.findIndex(e=>e===t)}resetTabIndexAndSetFocus(t,e){t!==e&&(this.menuItems[e].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.menuItems[t].focus())}closeAllMenuPopovers(t){for(;l.peek()!==t;){const e=l.pop();if(e)e.hidePopover();else break}}hasSubmenuWithTriggerId(t){var e;return((e=this.parentElement)==null?void 0:e.querySelector(`${h}[triggerid="${t}"]`))!==null}handleMouseClick(t){const e=t.target,i=e.getAttribute("id");y(e)&&!this.hasSubmenuWithTriggerId(i)&&this===e.closest(h)&&(this.closeAllMenuPopovers(),e.dispatchEvent(new Event("action",{bubbles:!0,composed:!0})))}resolveDirectionKey(t,e){if(!e)return t;switch(t){case o.ARROW_LEFT:return o.ARROW_RIGHT;case o.ARROW_RIGHT:return o.ARROW_LEFT;default:return t}}handleKeyDown(t){var n,c;const e=this.getCurrentIndex(t.target);if(e===-1)return;const i=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(t.key,i)){case o.HOME:{this.resetTabIndexAndSetFocus(0,e);break}case o.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,e);break}case o.ARROW_DOWN:{const a=e+1===this.menuItems.length?0:e+1;this.resetTabIndexAndSetFocus(a,e);break}case o.ARROW_UP:{const a=e-1===-1?this.menuItems.length-1:e-1;this.resetTabIndexAndSetFocus(a,e);break}case o.ARROW_RIGHT:{const a=(n=this.menuItems[e])==null?void 0:n.getAttribute("id");if(this.hasSubmenuWithTriggerId(a)){const m=(c=this.parentElement)==null?void 0:c.querySelector(`${h}[triggerid="${a}"]`);m&&m.showPopover()}break}case o.ARROW_LEFT:{P(this.parentElement)&&(this.hidePopover(),this.resetTabIndexAndSetFocus(0,e));break}case o.ESCAPE:{this.resetTabIndexAndSetFocus(0,e);break}}}};p.styles=[...f.styles,...C];let d=p;S([E({type:String,reflect:!0})],d.prototype,"placement");d.register(h);
