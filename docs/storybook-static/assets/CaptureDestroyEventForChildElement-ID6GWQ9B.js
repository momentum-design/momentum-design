import{b as d}from"./listitem.component-C2G9DK_r.js";const n=(a,e)=>!!(a.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING),o=a=>!!a;class E{constructor(e,t){this.cache=[],this.itemCreationHandler=s=>{this.addItem(s.target,void 0)},this.itemDestroyHandler=s=>{this.delete(s.target)},this.host=e,e.addController(this),this.isValidItem=(t==null?void 0:t.isValidItem)||o,this.onStoreUpdate=t==null?void 0:t.onStoreUpdate}get items(){return this.cache}hostConnected(){this.host.addEventListener(d.CREATED,this.itemCreationHandler),this.host.addEventListener(d.DESTROYED,this.itemDestroyHandler)}hostDisconnected(){this.host.removeEventListener(d.CREATED,this.itemCreationHandler),this.host.removeEventListener(d.DESTROYED,this.itemDestroyHandler),this.reset()}add(e){this.addItem(e,void 0)}addAt(e,t){this.addItem(e,t)}addItem(e,t=void 0){var i;const s=e;if(this.isValidItem(s)&&!this.cache.includes(s)){const h=t===void 0?this.cache.findIndex(r=>n(s,r)):t;this.onStoreUpdate&&((i=this.onStoreUpdate)==null||i.call(this,s,"added",h===-1?this.cache.length:h,this.cache.slice())),h===-1?this.cache.push(s):h>=0&&this.cache.splice(h,0,s)}}delete(e){var s;const t=this.cache.indexOf(e);t!==-1&&(this.onStoreUpdate&&((s=this.onStoreUpdate)==null||s.call(this,e,"removed",t,this.cache.slice())),this.cache.splice(t,1))}reset(e){this.cache.length=0,e&&this.cache.push(...e)}}const l=a=>{class e extends a{constructor(...s){super(...s),this.handleItemCreation=i=>{const h=i.target;h&&h.addEventListener(d.DESTROYED,this.handleItemRemovedEvent)},this.handleItemRemovedEvent=i=>{if(i.stopImmediatePropagation(),i.target&&i.type===d.DESTROYED){i.target.removeEventListener(d.DESTROYED,this.handleItemRemovedEvent);const h=new Event(i.type,{bubbles:i.bubbles,composed:i.composed});Object.defineProperty(h,"target",{set(){},get:()=>i.target}),this.dispatchEvent(h)}},this.addEventListener(d.CREATED,this.handleItemCreation)}}return e};export{l as C,E};
