import{n as p}from"./iframe-BStS_Y8s.js";import{f}from"./dom-BlZvhF8F.js";const d=class d{static get stackArray(){return Array.from(this.stack)}static getActiveTrap(){return this.stackArray.at(-1)}static addKeydownListener(e){this.currentKeydownListener=e,document.addEventListener("keydown",e)}static removeKeydownListener(){this.currentKeydownListener&&document.removeEventListener("keydown",this.currentKeydownListener)}static activate(e){this.stackArray.forEach(n=>{n!==e&&n.setIsFocusTrapActivated(!1)}),this.stack.add(e),this.removeKeydownListener(),this.addKeydownListener(e.handleTabKeydown.bind(e))}static deactivate(e){if(this.stack.has(e)&&(this.stack.delete(e),this.removeKeydownListener(),this.stack.size>0)){const n=this.stackArray.pop();n&&(n.setIsFocusTrapActivated(!0),this.addKeydownListener(n.handleTabKeydown.bind(n)))}}};d.stack=new Set,d.currentKeydownListener=null;let l=d;var m=Object.defineProperty,v=(c,e,n,t)=>{for(var s=void 0,o=c.length-1,i;o>=0;o--)(i=c[o])&&(s=i(e,n,s)||s);return s&&m(e,n,s),s};const b=c=>{class e extends c{constructor(){super(...arguments),this.shouldFocusTrapWrap=!0,this.focusTrapIndex=-1,this.focusableElements=[],this.isFocusTrapActivated=!1}setIsFocusTrapActivated(t){this.isFocusTrapActivated=t}activateFocusTrap(){this.setIsFocusTrapActivated(!0),l.activate(this)}deactivateFocusTrap(){this.setIsFocusTrapActivated(!1),l.deactivate(this),this.focusTrapIndex=-1}setFocusableElements(){this.shadowRoot&&(this.focusableElements=f(this.shadowRoot))}setInitialFocus(t=0){this.setFocusableElements(),!(this.focusableElements.length===0||!this.focusTrap)&&this.focusableElements[t]&&(this.focusTrapIndex=t,this.focusableElements[t].focus({preventScroll:!0}))}calculateNextIndex(t,s){const{length:o}=this.focusableElements;if(t===-1)return s>0?0:o-1;let i=t+s;return this.shouldFocusTrapWrap?(i<0&&(i=o-1),i>=o&&(i=0)):(i<0&&(i=0),i>=o&&(i=o-1)),i}getDeepActiveElement(){var s;let t=document.activeElement||document.body;for(;t instanceof HTMLElement&&((s=t.shadowRoot)!=null&&s.activeElement);)t=t.shadowRoot.activeElement;return t||document.body}findElement(t){return this.focusableElements.findIndex(s=>this.isEqualFocusNode(t,s))}isEqualFocusNode(t,s){return t.nodeType>=0?s.isEqualNode(t)&&s===t:!1}trapFocus(t){if(this.setFocusableElements(),this.focusableElements.length===0)return;const s=this.getDeepActiveElement(),o=this.findElement(s);t.shiftKey?this.focusTrapIndex=this.calculateNextIndex(o,-1):this.focusTrapIndex=this.calculateNextIndex(o,1);const a=this.focusableElements[this.focusTrapIndex];a.tagName!=="IFRAME"&&a&&(t.preventDefault(),a.focus())}handleTabKeydown(t){this.isFocusTrapActivated&&t.key==="Tab"&&this.trapFocus(t)}}return v([p({type:Boolean,reflect:!0,attribute:"should-focus-trap-wrap"})],e.prototype,"shouldFocusTrapWrap"),e},k=c=>{class e extends c{constructor(){super(...arguments),this.isPreventScrollActive=!1,this.previousDocumentBodyStyleOverflow=""}activatePreventScroll(){this.preventScroll&&!this.isPreventScrollActive&&(this.isPreventScrollActive=!0,this.previousDocumentBodyStyleOverflow=document.body.style.overflow,document.body.style.overflow="hidden")}deactivatePreventScroll(){this.isPreventScrollActive&&(this.isPreventScrollActive=!1,document.body.style.overflow=this.previousDocumentBodyStyleOverflow)}}return e},r=[],E=1e3,y=3,h=-2,u=-1;class x{constructor(e){this.host=e,e.addController(this)}hostConnected(){}hostDisconnected(){this.remove([this.host])}get length(){return r.length}pushHost(){var e,n;return this.has(this.host)?!1:(r.push(this.host),(n=(e=this.host).onComponentStackChanged)==null||n.call(e,"added"),!0)}popHost(){return this.popItem(this.host)}popItem(e){if(this.has(e)){const n=r.indexOf(e)-1;this.popUntil((t,s)=>t!==e&&t.triggerID===e.triggerID?"skip":s!==n)}}pop(){var n;const e=r.pop();return(n=e==null?void 0:e.onComponentStackChanged)==null||n.call(e,"removed"),e}popUntil(e){const n=[];for(let t=r.length-1;t>=0;t-=1){const s=r[t],o=e(s,t);if(o===!1)break;o!=="skip"&&n.push(s)}return this.remove(n)}peek(){return r.at(-1)}remove(e){var s,o;const n=e.filter(i=>r.includes(i)),t=n.reduce((i,a)=>Math.min(i,r.indexOf(a)),1/0);n.forEach(i=>{var a;r.splice(r.indexOf(i),1),(a=i==null?void 0:i.onComponentStackChanged)==null||a.call(i,"removed")});for(let i=t;i<r.length;i+=1)(o=(s=r[i]).onComponentStackChanged)==null||o.call(s,"moved");return n}has(e){return r.includes(e)}getHostDepth(){return this.getElementDepth(this.host)}getElementDepth(e){return r.indexOf(e)}getHostZIndex(){return this.getItemZIndex(this.host)}getItemZIndex(e){const n=this.getElementDepth(e);return n>=0?E+n*y:-1}isHostOnTop(){return this.peek()===this.host}clear(){this.popUntil(()=>!0)}}const w=c=>{class e extends c{constructor(){super(...arguments),this.isBackdropInvisible=!1,this.backdropElement=null,this.triggerElementCache=null}update(t){var s;if(super.update(t),t.has("zIndex")&&this.backdropElement){this.backdropElement.style.zIndex=`${this.zIndex+h}`;const o=(s=this.triggerElementCache)==null?void 0:s.deref();o&&(o.style.zIndex=`${this.zIndex+u}`)}}createBackdrop(t){const s=document.createElement("div");s.classList.add(`${t}-backdrop`);const o=document.createElement("style");o.textContent=`
        .${t}-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: ${this.isBackdropInvisible?"transparent":"var(--mds-color-theme-common-overlays-secondary-normal)"};
          z-index: ${this.zIndex+h};
        }
      `,s.appendChild(o);const a=document.getElementById(this.backdropAppendTo)||this.parentElement;a==null||a.appendChild(s),this.backdropElement=s}removeBackdrop(){this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}keepElementAboveBackdrop(t){t&&(this.triggerElementCache=new WeakRef(t),this.elementOriginalStyle={zIndex:t.style.zIndex,position:t.style.position},t.style.zIndex=`${this.zIndex+u}`,["fixed","absolute"].includes(window.getComputedStyle(t).position)||(t.style.position="relative"))}moveElementBackAfterBackdropRemoval(t){!t||!this.elementOriginalStyle||(t.style.zIndex=this.elementOriginalStyle.zIndex,t.style.position=this.elementOriginalStyle.position,this.elementOriginalStyle=void 0,this.triggerElementCache=null)}}return e};export{w as B,x as D,b as F,k as P};
