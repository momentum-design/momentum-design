import{u as I,a2 as E,R as o,k as M,C as p}from"./iframe-Cdt4WgmD.js";import{o as A}from"./query-assigned-elements-C7izZX_h.js";import{P as T}from"./popover.constants-BlmGq0cc.js";import{b as u,T as l}from"./menupopover.constants-BgRGv5cq.js";import{T as b}from"./menuitemradio.constants-BaPrFJR6.js";import{D as v}from"./BackdropMixin-BV7mmXg_.js";import{K as N,a as y,N as w,A as a}from"./KeyDownHandledMixin-DVdfAO8c.js";const d=I.constructTagName("menubar"),k={ORIENTATION:"vertical"},C=E`
  :host {
    display: flex;
  }

  :host([aria-orientation='horizontal']) {
    flex-direction: row;
  }

  :host([aria-orientation='vertical']) {
    flex-direction: column;
  }
`,O=[C];var S=Object.defineProperty,x=(f,t,e,n)=>{for(var s=void 0,i=f.length-1,r;i>=0;i--)(r=f[i])&&(s=r(t,e,s)||s);return s&&S(t,e,s),s};const m=class m extends N(y(p)){constructor(){super(),this.depthManager=new v(this),this.handleClick=t=>{if(t.composed&&t.composedPath().find(e=>e===this)){const e=t.target;if(!e||!this.isTopLevelMenuItem(e))return;const n=this.menuItems.filter(i=>i!==e);this.getVisibleSubMenusOfItems(n).forEach(i=>{i.hide()})}},this.addEventListener("keydown",this.handleKeyDown.bind(this))}async connectedCallback(){var t;super.connectedCallback(),this.role=o.MENUBAR,this.ariaOrientation=k.ORIENTATION,document.addEventListener("click",this.handleClick,{capture:!0}),await this.updateComplete,(t=this.menusections)==null||t.forEach(e=>{e.setAttribute("divider-variant","gradient")})}async disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("click",this.handleClick,{capture:!0})}get menuItems(){var i;const t=(i=this.shadowRoot)==null?void 0:i.querySelector("slot"),e=(t==null?void 0:t.assignedElements({flatten:!0}))??[],n=[],s=r=>{r.role===o.MENUITEM&&!r.hasAttribute("disabled")?n.push(r):r.tagName.toLowerCase()===b&&Array.from(r.children).forEach(s)};return e.forEach(s),n}getVisibleSubMenusOfItems(t){const e=[];return!t||t.length===0||t.forEach(n=>{var r;const s=n.getAttribute("id");if(!s)return;const i=(r=document.querySelector)==null?void 0:r.call(document,`${u}[triggerid="${s}"]`);i&&i.visible&&e.push(i)}),e}getAllPopovers(){var s;if(!this.menuItems.length)return[];const t=((s=this.menuItems[0])==null?void 0:s.closest(l))??this;if(!t)return[];const e=[],n=i=>{i.querySelectorAll(`${u}`).forEach(r=>{e.push(r)}),i.querySelectorAll("slot").forEach(r=>{r.assignedElements({flatten:!0}).forEach(n)})};return n(t),e}update(t){super.update(t)}firstUpdated(t){super.firstUpdated(t),this.resetTabIndexAndSetActiveTabIndex(this.menuItems),this.updatePopoverPlacement()}resetTabIndexAndSetActiveTabIndex(t){t.forEach((e,n)=>{const s=n===0?"0":"-1";e==null||e.setAttribute("tabindex",s)})}getCurrentIndex(t){return this.menuItems.findIndex(e=>e===t||e===t.parentElement)}getSubmenu(t){if(t)return this.getAllPopovers().find(e=>e.getAttribute("triggerid")===t)}showSubmenu(t){if(!t||!this.menuItems.find(s=>s.getAttribute("id")===t))return;const n=this.getSubmenu(t);n&&n.show()}updatePopoverPlacement(){const t=T.RIGHT_START;this.getAllPopovers().forEach(e=>{e.setAttribute("placement",t)})}updateTabIndexAndFocus(t,e,n){var s,i;n<0||e<0||(e!==n&&((s=t[e])==null||s.setAttribute("tabindex","-1"),(i=t[n])==null||i.setAttribute("tabindex","0")),t[n]&&(t[n].focus(),this.keyDownEventHandled()))}navigateToMenuItem(t,e,n=!1){var h;const{length:s}=this.menuItems;if(s===0)return;let i=t;if(this.getKeyboardNavMode()===w.DEFAULT?i=e==="prev"?(t-1+s)%s:(t+1)%s:i=e==="prev"?Math.max(0,t-1):Math.min(t+1,s-1),i!==t&&(this.keyDownEventHandled(),this.updateTabIndexAndFocus(this.menuItems,t,i),n)){const g=(h=this.menuItems[i])==null?void 0:h.getAttribute("id");this.getSubmenu(g)&&!this.menuItems[i].hasAttribute("soft-disabled")&&(this.showSubmenu(g),this.keyDownEventHandled())}}isTopLevelMenuItem(t){var i;const e=t.parentElement;if(!e||t.role!==o.MENUITEM)return!1;const n=e.tagName.toLowerCase(),s=(i=e.parentElement)==null?void 0:i.tagName.toLowerCase();return n===d||n===l||n===b&&(s===d||s===l)}isNestedMenuItem(t){return!!t.closest(u)&&t.role===o.MENUITEM}async closeAllMenuPopovers(){const t=this.depthManager.popUntil(e=>this.contains(e));await Promise.all(t.map(e=>e.updateComplete))}async crossMenubarNavigationOnLeft(t){if(t.role===o.MENUITEM){const n=t.closest(u),s=n==null?void 0:n.getAttribute("triggerid"),i=this.menuItems.find(r=>r.getAttribute("id")===s);if(i){this.isTopLevelMenuItem(i)&&(n==null||n.hide()),await(n==null?void 0:n.updateComplete);const r=this.getCurrentIndex(i);this.navigateToMenuItem(r,"prev",!0)}}}async crossMenubarNavigationOnRight(t){if(this.isTopLevelMenuItem(t)&&this.getSubmenu(t.id)&&!t.hasAttribute("soft-disabled"))this.showSubmenu(t.id),this.keyDownEventHandled();else if(this.isNestedMenuItem(t)&&!this.getSubmenu(t.id)){await this.closeAllMenuPopovers();const e=this.getParentMenuItemIndex(t);this.keyDownEventHandled(),e>=0&&this.navigateToMenuItem(e,"next",!0)}}getParentMenuItemIndex(t){let e=t.parentElement;for(;e;){if(e.tagName.toLowerCase()===u){const n=e.getAttribute("triggerid"),s=this.menuItems.find(i=>i.getAttribute("id")===n);if(s)return this.isTopLevelMenuItem(s)?this.menuItems.findIndex(i=>i===s):this.getParentMenuItemIndex(s)}e=e.parentElement}return-1}async handleKeyDown(t){const e=this.getCurrentIndex(t.target);switch(this.getActionForKeyEvent(t,!0)){case a.HOME:this.updateTabIndexAndFocus(this.menuItems,e,0);break;case a.END:this.updateTabIndexAndFocus(this.menuItems,e,this.menuItems.length-1);break;case a.LEFT:{const s=e>=0?this.menuItems[e]:t.target;await this.crossMenubarNavigationOnLeft(s);break}case a.RIGHT:{const s=e>=0?this.menuItems[e]:t.target;await this.crossMenubarNavigationOnRight(s);break}case a.UP:{this.navigateToMenuItem(e,"prev"),t.preventDefault();break}case a.DOWN:{this.navigateToMenuItem(e,"next"),t.preventDefault();break}}}render(){return M`<slot></slot>`}};m.styles=[...p.styles,...O];let c=m;x([A({selector:"mdc-menusection",flatten:!0})],c.prototype,"menusections");c.register(d);
