import{b as h}from"./listitem.component-oNCbOuja.js";const n=(d,e)=>!!(d.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING),o=d=>!!d;class l{constructor(e,t){this.cache=[],this.itemCreationHandler=i=>{this.addItem(i.target,void 0)},this.itemDestroyHandler=i=>{this.delete(i.detail.originalTarget)},this.host=e,e.addController(this),this.isValidItem=(t==null?void 0:t.isValidItem)||o,this.onStoreUpdate=t==null?void 0:t.onStoreUpdate}get items(){return this.cache}hostConnected(){this.host.addEventListener(h.CREATED,this.itemCreationHandler),this.host.addEventListener(h.DESTROYED,this.itemDestroyHandler)}hostDisconnected(){this.host.removeEventListener(h.CREATED,this.itemCreationHandler),this.host.removeEventListener(h.DESTROYED,this.itemDestroyHandler),this.reset()}add(e){this.addItem(e,void 0)}addAt(e,t){this.addItem(e,t)}addItem(e,t=void 0){var s;const i=e;if(this.isValidItem(i)&&!this.cache.includes(i)){const a=t===void 0?this.cache.findIndex(r=>n(i,r)):t;this.onStoreUpdate&&((s=this.onStoreUpdate)==null||s.call(this,i,"added",a===-1?this.cache.length:a,this.cache.slice())),a===-1?this.cache.push(i):a>=0&&this.cache.splice(a,0,i)}}delete(e){var i;const t=this.cache.indexOf(e);t!==-1&&(this.onStoreUpdate&&((i=this.onStoreUpdate)==null||i.call(this,e,"removed",t,this.cache.slice())),this.cache.splice(t,1))}reset(e){this.cache.length=0,e&&this.cache.push(...e)}}const m=d=>{class e extends d{constructor(...i){super(...i),this.handleItemCreation=s=>{const a=s.target;a&&a.addEventListener(h.DESTROYED,this.handleItemRemovedEvent)},this.handleItemRemovedEvent=s=>{s.stopImmediatePropagation(),s.target&&s.type===h.DESTROYED&&(s.target.removeEventListener(h.DESTROYED,this.handleItemRemovedEvent),this.dispatchEvent(new CustomEvent(s.type,{bubbles:s.bubbles,composed:s.composed,detail:{originalTarget:s.target}})))},this.addEventListener(h.CREATED,this.handleItemCreation)}}return e};export{m as C,l as E};
