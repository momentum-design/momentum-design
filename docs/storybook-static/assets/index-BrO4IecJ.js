import{n as E}from"./index-C9z9WAEj.js";import{K as o}from"./listitem.component-Bh3_BYs0.js";import{R as m}from"./roles-BH_hBfTz.js";import{T}from"./menusection.constants-BCYXL6dH.js";import{a as g,p as l,C as k}from"./popover.component-Bw5zQP8M.js";import{T as c,D as f}from"./menupopover.constants-Df21F9dQ.js";import{i as v}from"./lit-element-D5KKan5q.js";import{T as b}from"./menuitem.component-C82Go1iM.js";import{T as I}from"./menuitemcheckbox.constants-DmrkQGAP.js";import{T as R}from"./menuitemradio.constants-CPWIpsqE.js";const O=v`
  :host::part(popover-content) {
    padding: 0.75rem 0.5rem;
  }

  ::slotted(mdc-divider) {
    margin-block: 0.25rem;
  }
`,C=[O],A=r=>{var e,t;return[b,I,R].includes((t=(e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))},w=r=>{var e;return((e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase())===c},S=r=>{var e,t;return((t=(e=r==null?void 0:r.tagName)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))===b&&!r.hasAttribute("disabled")};var y=Object.defineProperty,P=(r,e,t,i)=>{for(var s=void 0,n=r.length-1,h;n>=0;n--)(h=r[n])&&(s=h(e,t,s)||s);return s&&y(e,t,s),s};const u=class u extends g{constructor(){super(),this.placement=f.PLACEMENT,this.onOutsidePopoverClick=e=>{if(l.peek()!==this)return;const t=e.target.closest(c);if(t&&l.has(t)){this.closeAllMenuPopovers(t);return}const i=e.composedPath(),s=this.contains(e.target)||i.includes(this.triggerElement),n=this.backdropElement?i.includes(this.backdropElement):!1;(!s||n)&&this.closeAllMenuPopovers()},this.togglePopoverVisible=()=>{var e;(e=this.triggerElement)!=null&&e.hasAttribute("soft-disabled")||(this.isTriggerClicked?this.hidePopover():(this.showPopover(),this.isTriggerClicked=!0))},this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("click",this.handleMouseClick)}get menuItems(){var i;const e=(i=this.shadowRoot)==null?void 0:i.querySelector("slot");return((e==null?void 0:e.assignedElements({flatten:!0}))||[]).map(s=>s.tagName.toLowerCase()===T?Array.from(s.children).filter(n=>A(n)):A(s)?s:[]).flat().filter(s=>!!s&&!s.hasAttribute("disabled"))}connectedCallback(){super.connectedCallback(),this.role=m.MENU,this.ariaOrientation=f.ORIENTATION,this.backdrop=!1,this.color=k.TONAL,this.disableAriaExpanded=!1,this.focusBackToTrigger=!0,this.focusTrap=!0,this.hideOnEscape=!0,this.hideOnOutsideClick=!0,this.interactive=!0,this.showArrow=!1,this.closeButton=!1,this.closeButtonAriaLabel=null}async firstUpdated(e){var t;await super.firstUpdated(e),this.menuItems.length>0&&(this.menuItems.forEach(i=>i.setAttribute("tabindex","-1")),this.menuItems[0].setAttribute("tabindex","0")),(t=this.triggerElement)==null||t.setAttribute("aria-haspopup",m.MENU)}getCurrentIndex(e){return this.menuItems.findIndex(t=>t===e)}resetTabIndexAndSetFocus(e,t){e!==t&&(this.menuItems[t].setAttribute("tabindex","-1"),this.menuItems[e].setAttribute("tabindex","0"),this.menuItems[e].focus())}closeAllMenuPopovers(e){for(;l.peek()!==e;){const t=l.pop();if(t)t.hidePopover();else break}}hasSubmenuWithTriggerId(e){var t;return((t=this.parentElement)==null?void 0:t.querySelector(`${c}[triggerid="${e}"]`))!==null}handleMouseClick(e){const t=e.target,i=t.getAttribute("id");S(t)&&!this.hasSubmenuWithTriggerId(i)&&this===t.closest(c)&&(this.closeAllMenuPopovers(),t.dispatchEvent(new Event("action",{bubbles:!0,composed:!0})))}resolveDirectionKey(e,t){if(!t)return e;switch(e){case o.ARROW_LEFT:return o.ARROW_RIGHT;case o.ARROW_RIGHT:return o.ARROW_LEFT;default:return e}}handleKeyDown(e){var n,h;const t=this.getCurrentIndex(e.target);if(t===-1)return;const i=window.getComputedStyle(this).direction==="rtl";switch(this.resolveDirectionKey(e.key,i)){case o.HOME:{this.resetTabIndexAndSetFocus(0,t);break}case o.END:{this.resetTabIndexAndSetFocus(this.menuItems.length-1,t);break}case o.ARROW_DOWN:{const a=t+1===this.menuItems.length?0:t+1;this.resetTabIndexAndSetFocus(a,t);break}case o.ARROW_UP:{const a=t-1===-1?this.menuItems.length-1:t-1;this.resetTabIndexAndSetFocus(a,t);break}case o.ARROW_RIGHT:{const a=(n=this.menuItems[t])==null?void 0:n.getAttribute("id");if(this.hasSubmenuWithTriggerId(a)){const p=(h=this.parentElement)==null?void 0:h.querySelector(`${c}[triggerid="${a}"]`);p&&p.showPopover()}break}case o.ARROW_LEFT:{w(this.parentElement)&&(this.hidePopover(),this.resetTabIndexAndSetFocus(0,t));break}case o.ESCAPE:{this.resetTabIndexAndSetFocus(0,t);break}}}};u.styles=[...g.styles,...C];let d=u;P([E({type:String,reflect:!0})],d.prototype,"placement");d.register(c);
