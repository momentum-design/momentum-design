---
import path from 'path';
import DocsLayout from '../../../../layouts/DocsLayout.astro';

export async function getStaticPaths() {
  const processMDFiles = (compiledContent: string, packageName: string) => compiledContent
    // fix all urls inside the autogenerated API reference to point to correct URL
    .replaceAll('./', `/momentum-design/en/docs/api-reference/${packageName}/`);

  const pages = await Astro.glob('../../../../../../*/*.md');
  return pages.map((page) => {
    const paths = page.file?.split('/');
    // go back 1 directories to get the package name
    const fileName = paths.pop() || '';
    const subPackage = paths.pop() || '';

    return {
      params: { readme: path.join(subPackage, fileName) },
      props: { page: { ...page, compiledContent: processMDFiles(page.compiledContent(), subPackage) } },
    };
  });
}
const { page } = Astro.props;

---

<DocsLayout frontmatter={{ description: '', title: '', layout: '' }} headings={page.getHeadings()}>
  <page.Content />
</DocsLayout>
