{/* popover.accessibility.stories.mdx */}
import { Meta, Title, Primary, Controls } from '@storybook/blocks';

import * as PopoverStories from './popover.stories';

<Meta of={PopoverStories} name="User Stories" />

<Title>User Stories</Title>

### ✅ Default Behavior

**Scenario: Toggle popover on button click (mouse)**  
> Given a trigger element such as a button,  
> When the user clicks on the button,  
> Then the popover should become visible if it was hidden,  
> And the popover should become hidden if it was already visible.

**Scenario: Toggle popover on button activation (keyboard)**  
> Given a trigger element is focused,  
> When the user presses the **Space** or **Enter** key,  
> Then the popover should become visible if it was hidden,  
> And the popover should become hidden if it was already visible.

---

### ✅ Attributes

**Scenario: Role attribute**  
> Given a popover component,  
> Then its default role should be set to `dialog`,  
> And the role can be customized using the `role` attribute.

**Scenario: Default placement**  
> Given a popover component,  
> Then it should be placed below the trigger element by default,  
> And the placement can be modified using the `placement` attribute to top, left, right, bottom, etc.

**Scenario: Initial visibility**  
> Given a popover component, which is hidden by default,  
> When `visible` attribute is set,
> Then the popover should be visible.

**Scenario: Display arrow**  
> Given a popover component,  
> When the `show-arrow` attribute is set to `true`,  
> Then an arrow should be displayed connecting the popover visually to its trigger.

**Scenario: Interactive popover**  
> Given a popover contains interactive content,  
> Then the `interactive` attribute should be set to `true`.  
> When the content is static or non-interactive,  
> Then the `interactive` attribute is not required.

**Scenario: Hide on outside click**  
> Given the `hide-on-outside-click` attribute is set to `true`,  
> When the user clicks outside the popover,  
> Then the popover should close.

**Scenario: Hide on blur (focus out)**  
> Given the `hide-on-blur` attribute is set to `true`,  
> When the user shifts focus away from the popover,  
> Then the popover should close.

**Scenario: Focus trap inside popover**  
> Given the popover contains interactive content,  
> When the `focus-trap` attribute is enabled,  
> Then the user should not be able to move focus outside the popover until it is closed.

**Scenario: Prevent outside scroll**  
> Given the `prevent-scroll` attribute is set,  
> When the popover is open,  
> Then scrolling the background page should be disabled.

**Scenario: Close button inside popover**  
> Given the `close-button` attribute is set,  
> Then an "X" icon should appear inside the popover.  
> When the user clicks the close button,  
> Then the popover should close.  
> And the close button can have an accessible label via `close-button-aria-label`.

---

### ✅ Accessibility

**Scenario: Default accessibility attributes**  
> Given a popover is used,  
> Then it should have a default role of `dialog`.  
> And it can support `aria-label`, `aria-labelledby`, and `aria-describedby`.  
> When the popover is interactive,  
> Then the trigger should have `aria-haspopup` set to `dialog` (by default),  
> And the user can override `aria-haspopup` if needed.  
> When the popover is open,  
> Then the trigger should have `aria-expanded="true"`.  
> When the popover is closed,  
> Then the trigger should have `aria-expanded="false"`.  
> **If** the popover is non-interactive,  
> Then the `disable-aria-expanded` attribute should be used to remove `aria-expanded`.  
> When the popover is interactive and has a role of `dialog` or `alertdialog`,  
> Then the `aria-modal` attribute should be set to `true`.

---

### ✅ Nested Popovers

**Scenario: Close only child popover on outside click**  
> Given a parent popover and a nested child popover are both open,  
> And both have the `hide-on-outside-click` attribute set,  
> When the user clicks outside the child popover,  
> Then only the child popover should close,  
> And the parent popover should remain open.  
> When the user clicks outside again,  
> Then the parent popover should close.

---
