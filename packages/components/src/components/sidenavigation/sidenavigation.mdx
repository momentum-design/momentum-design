{/* sidenavigation.accessibility.stories.mdx */}
import { Meta, Title, Primary, Controls } from '@storybook/blocks';

import SideNavigationStories from './sidenavigation.stories';

<Meta of={SideNavigationStories} name="User Stories" />

<Title>User Stories</Title>

### ✅ Basic Rendering

**Scenario: Display sidenav on page load**  
> Given I am a user on the home page  
> Then I should see the side navigation on the left side of the screen

---

### ✅ Expand/Collapse Behavior

**Scenario: Collapse the sidenav using mouse**  
> Given the sidenav is visible and expanded  
> When I click on the arrow (collapse) button with the mouse  
> Then the sidenav should collapse and show only icons

**Scenario: Collapse the sidenav using keyboard**  
> Given the sidenav is visible and expanded  
> When navigating to the arrow (collapse) button using keyboard (pressing Tab)  
> And the arrow button is focused  
> When I press the "Enter" or "Space" key  
> Then the sidenav should collapse and show only icons  
> And the arrow button should retain focus

**Scenario: Expand the sidenav using mouse**  
> Given the sidenav is visible and collapsed  
> When I click on the arrow (expand) button with the mouse  
> Then the sidenav should expand and show labels next to icons

**Scenario: Expand the sidenav using keyboard**  
> Given the sidenav is visible and collapsed  
> When navigating to the arrow (expand) button using keyboard (pressing Tab)  
> And the arrow button is focused  
> When I press the "Enter" or "Space" key  
> Then the sidenav should expand and show labels next to icons  
> And the arrow button should retain focus

---

### ✅ Scroll Behavior

**Scenario: Scroll to reveal more top navigation items using mouse or touch**  
> Given the sidenav is visible and has more navigation items than can fit in the view  
> And there is a fixed section at the bottom of the sidenav with nav items  
> When I scroll the sidenav using the mouse wheel or swipe up with touch  
> Then the upper navigation items should scroll to reveal hidden items  
> And the fixed section at the bottom should always remain visible and not scroll out of view

---

### ✅ Navigation Items Selection

**Feature: Selecting a Top-Level Navigation Item**

**Scenario: Navigating to a new page by mouse click**  
> Given the side navigation is visible  
> And a navigation item does not have any submenu  
> When I click on that navigation item  
> Then that item should appear selected  
> And the main content area should update to show the corresponding page  
> And the previously selected item should no longer appear selected

**Scenario: Navigating to a new page by keyboard**  
> Given the side navigation is visible  
> And a navigation item does not have any submenu  
> When I navigate to the navigation item using the keyboard (e.g., pressing Tab)  
> And the navigation item is focused  
> And I press "Enter" or "Space"  
> Then that item should appear selected  
> And the main content area should update to show the corresponding page  
> And the previously selected item should no longer appear selected

**Scenario: Opening a submenu by mouse click**  
> Given the side navigation is visible  
> And a navigation item has a submenu  
> When I click on that navigation item  
> Then a submenu should open next to it in a floating panel  
> And I should be able to continue navigating using keyboard or mouse

**Scenario: Opening a submenu by keyboard**  
> Given the side navigation is visible  
> And a navigation item has a submenu  
> When I navigate to the navigation item using the keyboard (e.g., pressing Tab)  
> And the navigation item is focused  
> And I press "Enter", "Space", or "Right Arrow"  
> Then a submenu should open next to it in a floating panel  
> And the focus should move to the first focusable element inside the submenu  
> And I should be able to continue navigating using keyboard or mouse

**Scenario: Triggering an inline action by clicking a nav item**  
> Given the side navigation is visible  
> And an actionable nav item is present that performs an operation (e.g., opens a dialog/alert)  
> When I click on that actionable nav item  
> Then the associated action should be triggered  
> And no page navigation should occur

**Scenario: Triggering an inline action via keyboard**  
> Given the side navigation is visible  
> And focus is on an actionable nav item  
> When I press "Enter" or "Space"  
> Then the associated action should be triggered  
> And the focus should remain within the nav until the user intentionally moves it

**Feature: Selecting a navigation item inside a submenu**

**Scenario: Selecting a nested item with mouse or keyboard**  
> Given the side navigation is visible  
> And a submenu is open  
> When I activate a nested navigation item using the keyboard (e.g., navigating with Tab and pressing Enter/Space) or by mouse click  
> Then the main content area should update to show the corresponding page  
> And the submenu should close  
> And its parent nav item along the selection path should appear activated  
> And any previously activated nav item(s) outside of this active path should no longer appear activated  
> And if I used the keyboard, focus should return to the top-level parent item that opened the submenu

**Scenario: Re-engaging with the active top-level navigation item**  
> Given the side navigation is visible  
> And a nested navigation item was previously selected  
> And the submenu is currently closed  
> And the top-level parent of the previously selected nested item appears active  
> When I hover over that parent navigation item  
> Then I should see a tooltip indicating that an active nested navigation item exists within this section  
>
> When I interact with the top-level parent navigation item using the keyboard (e.g., Tab + Enter/Space) or mouse click  
> Then the submenu should reopen  
> And its parent nav item along the active path should appear selected

---

### ✅ Closing Submenus

**Feature: Dismissing submenus**

**Scenario: Closing submenus by clicking outside**  
> Given the side navigation is visible  
> And one or more submenus (including nested submenus) are open  
> When I click anywhere outside the side navigation and all open submenus  
> Or when I click on the top-level parent navigation item from which these submenus were opened  
> Then the last opened submenu should close  
> And if multiple submenus are open, clicking outside repeatedly should close them one by one

**Scenario: Closing submenus using keyboard shortcuts**  
> Given the side navigation is visible  
> And multiple submenus (including nested submenus) are open  
> And focus is on a nested navigation item inside the last opened submenu  
> When I press the "Escape" key or the "Left Arrow" key  
> Then the last opened submenu should close  
> And focus should move to the previously focused navigation item in the parent submenu  
> And repeating this action should continue closing submenus one by one and moving focus accordingly

> **Note**: All submenu behaviors described apply recursively for nested submenus at any depth.

---

### ✅ Accessibility

**Feature: Structure and Labels**

**Scenario: Clear structure for assistive technologies**  
> Given the side navigation is visible  
> Then the entire navigation area should be recognized as a navigation region  
> And each group of navigation items should be clearly labeled and treated as a menubar  
> And each individual item should be treated as a menuitem

**Scenario: Grabber button is announced properly**  
> Given the side navigation includes a button to expand or collapse it  
> And that button has a label set for screen readers  
> Then screen readers should announce that label clearly

**Feature: Screen Reader Support**

**Scenario: Announcing navigation items properly**  
> Given each navigation item has a label, icon, and sometimes a badge (like a count)  
> Then screen readers should announce the label  
> And include any extra info, like "Messaging 2", if there’s a badge

**Scenario: Active item is clearly communicated**  
> Given I’ve selected a navigation item  
> Then screen readers should understand it’s the current page

**Feature: Keyboard navigation within navigation items**

**Scenario: Navigating navigation items with Arrow keys**  
> Given the side navigation is visible or a submenu is open  
> When the user presses ArrowDown or ArrowUp  
> Then the focus should move cyclically between navigation items within that container

**Scenario: Not getting stuck in the navigation**  
> Given I’m using keyboard to explore the navigation  
> Then I should always be able to move out of it easily  
> Either by pressing Tab or Escape to go to the next part of the page

**Feature: Focus management within navigation items**

**Scenario: Focus management for opened submenus**  
> Given I open a submenu using keyboard or mouse  
> Then the focus should automatically move to the first item in the submenu  
> And when I close the submenu, focus should return to the parent item
